import asyncio
import edge_tts
from pathlib import Path
import random

# Configuration: language -> (num_samples, voice_name)
VOICE_CONFIG = {
    'hindi': {
        'count': 200,
        'voices': [
            'hi-IN-SwaraNeural',
            'hi-IN-MadhurNeural'
        ]
    },
    'tamil': {
        'count': 200,
        'voices': [
            'ta-IN-PallaviNeural',
            'ta-IN-ValluvarNeural'
        ]
    },
    'malayalam': {
        'count': 200,
        'voices': [
            'ml-IN-SobhanaNeural',
            'ml-IN-MidhunNeural'
        ]
    },
    'telugu': {
        'count': 200,
        'voices': [
            'te-IN-ShrutiNeural',
            'te-IN-MohanNeural'
        ]
    }
}

# Sample sentences for each language (you can expand these)
SAMPLE_TEXTS = {
    'english': [
        "Hello, how are you today?",
        "The weather is beautiful outside.",
        "I love learning new things every day.",
        "Technology is advancing rapidly.",
        "Please call me back when you can.",
        "What time is the meeting scheduled?",
        "I will be there in five minutes.",
        "Thank you for your help and support.",
        "This is a test of the emergency broadcast system.",
        "Artificial intelligence is changing the world.",
        "Can you hear me clearly?",
        "I need to finish this project today.",
        "The quick brown fox jumps over the lazy dog.",
        "Good morning, have a great day ahead.",
        "Let's schedule a meeting for next week.",
    ],
    'hindi': [
        "à¤¨à¤®à¤¸à¥à¤¤à¥‡, à¤†à¤ª à¤•à¥ˆà¤¸à¥‡ à¤¹à¥ˆà¤‚?",
        "à¤†à¤œ à¤®à¥Œà¤¸à¤® à¤¬à¤¹à¥à¤¤ à¤…à¤šà¥à¤›à¤¾ à¤¹à¥ˆà¥¤",
        "à¤®à¥à¤à¥‡ à¤°à¥‹à¤œ à¤¨à¤ˆ à¤šà¥€à¤œà¥‡à¤‚ à¤¸à¥€à¤–à¤¨à¤¾ à¤ªà¤¸à¤‚à¤¦ à¤¹à¥ˆà¥¤",
        "à¤¤à¤•à¤¨à¥€à¤• à¤¤à¥‡à¤œà¥€ à¤¸à¥‡ à¤†à¤—à¥‡ à¤¬à¤¢à¤¼ à¤°à¤¹à¥€ à¤¹à¥ˆà¥¤",
        "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤®à¥à¤à¥‡ à¤µà¤¾à¤ªà¤¸ à¤•à¥‰à¤² à¤•à¤°à¥‡à¤‚à¥¤",
        "à¤®à¥€à¤Ÿà¤¿à¤‚à¤— à¤•à¤¿à¤¤à¤¨à¥‡ à¤¬à¤œà¥‡ à¤¹à¥ˆ?",
        "à¤®à¥ˆà¤‚ à¤ªà¤¾à¤‚à¤š à¤®à¤¿à¤¨à¤Ÿ à¤®à¥‡à¤‚ à¤µà¤¹à¤¾à¤‚ à¤ªà¤¹à¥à¤‚à¤š à¤œà¤¾à¤Šà¤‚à¤—à¤¾à¥¤",
        "à¤†à¤ªà¤•à¥€ à¤®à¤¦à¤¦ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥¤",
        "à¤•à¥ƒà¤¤à¥à¤°à¤¿à¤® à¤¬à¥à¤¦à¥à¤§à¤¿à¤®à¤¤à¥à¤¤à¤¾ à¤¦à¥à¤¨à¤¿à¤¯à¤¾ à¤•à¥‹ à¤¬à¤¦à¤² à¤°à¤¹à¥€ à¤¹à¥ˆà¥¤",
        "à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤®à¥à¤à¥‡ à¤¸à¥à¤ªà¤·à¥à¤Ÿ à¤°à¥‚à¤ª à¤¸à¥‡ à¤¸à¥à¤¨ à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚?",
        "à¤®à¥à¤à¥‡ à¤¯à¤¹ à¤ªà¤°à¤¿à¤¯à¥‹à¤œà¤¨à¤¾ à¤†à¤œ à¤–à¤¤à¥à¤® à¤•à¤°à¤¨à¥€ à¤¹à¥ˆà¥¤",
        "à¤¶à¥à¤­ à¤ªà¥à¤°à¤­à¤¾à¤¤, à¤†à¤ªà¤•à¤¾ à¤¦à¤¿à¤¨ à¤¶à¥à¤­ à¤¹à¥‹à¥¤",
        "à¤†à¤‡à¤ à¤…à¤—à¤²à¥‡ à¤¸à¤ªà¥à¤¤à¤¾à¤¹ à¤•à¥‡ à¤²à¤¿à¤ à¤à¤• à¤¬à¥ˆà¤ à¤• à¤¨à¤¿à¤°à¥à¤§à¤¾à¤°à¤¿à¤¤ à¤•à¤°à¥‡à¤‚à¥¤",
        "à¤¯à¤¹ à¤¬à¤¹à¥à¤¤ à¤®à¤¹à¤¤à¥à¤µà¤ªà¥‚à¤°à¥à¤£ à¤¹à¥ˆà¥¤",
        "à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¯à¤¹à¤¾à¤‚ à¤¹à¥‚à¤‚à¥¤",
    ],
    'tamil': [
        "à®µà®£à®•à¯à®•à®®à¯, à®¨à¯€à®™à¯à®•à®³à¯ à®à®ªà¯à®ªà®Ÿà®¿ à®‡à®°à¯à®•à¯à®•à®¿à®±à¯€à®°à¯à®•à®³à¯?",
        "à®‡à®©à¯à®±à¯ à®µà®¾à®©à®¿à®²à¯ˆ à®®à®¿à®•à®µà¯à®®à¯ à®…à®´à®•à®¾à®• à®‡à®°à¯à®•à¯à®•à®¿à®±à®¤à¯.",
        "à®¨à®¾à®©à¯ à®¤à®¿à®©à®®à¯à®®à¯ à®ªà¯à®¤à®¿à®¯ à®µà®¿à®·à®¯à®™à¯à®•à®³à¯ˆà®•à¯ à®•à®±à¯à®±à¯à®•à¯à®•à¯Šà®³à¯à®³ à®µà®¿à®°à¯à®®à¯à®ªà¯à®•à®¿à®±à¯‡à®©à¯.",
        "à®¤à¯Šà®´à®¿à®²à¯à®¨à¯à®Ÿà¯à®ªà®®à¯ à®µà¯‡à®•à®®à®¾à®• à®®à¯à®©à¯à®©à¯‡à®±à®¿ à®µà®°à¯à®•à®¿à®±à®¤à¯.",
        "à®¤à®¯à®µà¯à®šà¯†à®¯à¯à®¤à¯ à®¤à®¿à®°à¯à®®à¯à®ª à®…à®´à¯ˆà®•à¯à®•à®µà¯à®®à¯.",
        "à®•à¯‚à®Ÿà¯à®Ÿà®®à¯ à®à®¨à¯à®¤ à®¨à¯‡à®°à®¤à¯à®¤à®¿à®²à¯ à®¤à®¿à®Ÿà¯à®Ÿà®®à®¿à®Ÿà®ªà¯à®ªà®Ÿà¯à®Ÿà¯à®³à¯à®³à®¤à¯?",
        "à®¨à®¾à®©à¯ à®à®¨à¯à®¤à¯ à®¨à®¿à®®à®¿à®Ÿà®™à¯à®•à®³à®¿à®²à¯ à®…à®™à¯à®•à¯ à®µà®°à¯à®µà¯‡à®©à¯.",
        "à®‰à®™à¯à®•à®³à¯ à®‰à®¤à®µà®¿à®•à¯à®•à¯ à®¨à®©à¯à®±à®¿.",
        "à®šà¯†à®¯à®±à¯à®•à¯ˆ à®¨à¯à®£à¯à®£à®±à®¿à®µà¯ à®‰à®²à®•à¯ˆ à®®à®¾à®±à¯à®±à¯à®•à®¿à®±à®¤à¯.",
        "à®¨à¯€à®™à¯à®•à®³à¯ à®à®©à¯à®©à¯ˆ à®¤à¯†à®³à®¿à®µà®¾à®•à®•à¯ à®•à¯‡à®Ÿà¯à®• à®®à¯à®Ÿà®¿à®¯à¯à®®à®¾?",
        "à®¨à®¾à®©à¯ à®‡à®©à¯à®±à¯ à®‡à®¨à¯à®¤ à®¤à®¿à®Ÿà¯à®Ÿà®¤à¯à®¤à¯ˆ à®®à¯à®Ÿà®¿à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯.",
        "à®•à®¾à®²à¯ˆ à®µà®£à®•à¯à®•à®®à¯, à®¨à®²à¯à®² à®¨à®¾à®³à¯ à®µà®¾à®´à¯à®¤à¯à®¤à¯à®•à¯à®•à®³à¯.",
        "à®…à®Ÿà¯à®¤à¯à®¤ à®µà®¾à®°à®®à¯ à®’à®°à¯ à®•à¯‚à®Ÿà¯à®Ÿà®¤à¯à®¤à¯ˆ à®¤à®¿à®Ÿà¯à®Ÿà®®à®¿à®Ÿà¯à®µà¯‹à®®à¯.",
        "à®‡à®¤à¯ à®®à®¿à®•à®µà¯à®®à¯ à®®à¯à®•à¯à®•à®¿à®¯à®®à®¾à®©à®¤à¯.",
        "à®¨à®¾à®©à¯ à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®‰à®¤à®µ à®‡à®™à¯à®•à¯‡ à®‡à®°à¯à®•à¯à®•à®¿à®±à¯‡à®©à¯.",
    ],
    'malayalam': [
        "à´¹à´²àµ‹, à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´à´™àµà´™à´¨àµ†à´¯àµà´£àµà´Ÿàµ?",
        "à´‡à´¨àµà´¨àµ à´•à´¾à´²à´¾à´µà´¸àµà´¥ à´µà´³à´°àµ† à´®à´¨àµ‹à´¹à´°à´®à´¾à´£àµ.",
        "à´à´¨à´¿à´•àµà´•àµ à´à´²àµà´²à´¾ à´¦à´¿à´µà´¸à´µàµà´‚ à´ªàµà´¤à´¿à´¯ à´•à´¾à´°àµà´¯à´™àµà´™àµ¾ à´ªà´ à´¿à´•àµà´•à´¾àµ» à´‡à´·àµà´Ÿà´®à´¾à´£àµ.",
        "à´¸à´¾à´™àµà´•àµ‡à´¤à´¿à´•à´µà´¿à´¦àµà´¯ à´…à´¤à´¿à´µàµ‡à´—à´‚ à´ªàµà´°àµ‹à´—à´®à´¿à´•àµà´•àµà´¨àµà´¨àµ.",
        "à´¦à´¯à´µà´¾à´¯à´¿ à´¤à´¿à´°à´¿à´•àµ† à´µà´¿à´³à´¿à´•àµà´•àµà´•.",
        "à´¯àµ‹à´—à´‚ à´à´ªàµà´ªàµ‹àµ¾ à´†à´£àµ à´¨à´¿à´¶àµà´šà´¯à´¿à´šàµà´šà´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨à´¤àµ?",
        "à´à´¾àµ» à´…à´àµà´šàµ à´®à´¿à´¨à´¿à´±àµà´±à´¿à´¨àµà´³àµà´³à´¿àµ½ à´…à´µà´¿à´Ÿàµ†à´¯àµ†à´¤àµà´¤àµà´‚.",
        "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´¸à´¹à´¾à´¯à´¤àµà´¤à´¿à´¨àµ à´¨à´¨àµà´¦à´¿.",
        "à´•àµƒà´¤àµà´°à´¿à´® à´¬àµà´¦àµà´§à´¿ à´²àµ‹à´•à´¤àµà´¤àµ† à´®à´¾à´±àµà´±à´¿à´®à´±à´¿à´•àµà´•àµà´¨àµà´¨àµ.",
        "à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´à´¨àµà´¨àµ† à´µàµà´¯à´•àµà´¤à´®à´¾à´¯à´¿ à´•àµ‡àµ¾à´•àµà´•à´¾à´®àµ‹?",
        "à´à´¨à´¿à´•àµà´•àµ à´‡à´¨àµà´¨àµ à´ˆ à´ªàµà´°àµ‹à´œà´•àµà´±àµà´±àµ à´ªàµ‚àµ¼à´¤àµà´¤à´¿à´¯à´¾à´•àµà´•à´£à´‚.",
        "à´¸àµà´ªàµà´°à´­à´¾à´¤à´‚, à´¨à´²àµà´² à´¦à´¿à´µà´¸à´‚ à´†à´¶à´‚à´¸à´¿à´•àµà´•àµà´¨àµà´¨àµ.",
        "à´…à´Ÿàµà´¤àµà´¤ à´†à´´àµà´š à´’à´°àµ à´¯àµ‹à´—à´‚ à´¨à´¿à´¶àµà´šà´¯à´¿à´•àµà´•à´¾à´‚.",
        "à´‡à´¤àµ à´µà´³à´°àµ† à´ªàµà´°à´§à´¾à´¨à´®à´¾à´£àµ.",
        "à´à´¾àµ» à´¨à´¿à´™àµà´™à´³àµ† à´¸à´¹à´¾à´¯à´¿à´•àµà´•à´¾àµ» à´‡à´µà´¿à´Ÿàµ†à´¯àµà´£àµà´Ÿàµ.",
    ],
    'telugu': [
        "à°¹à°²à±‹, à°®à±€à°°à± à°à°²à°¾ à°‰à°¨à±à°¨à°¾à°°à±?",
        "à°ˆà°°à±‹à°œà± à°µà°¾à°¤à°¾à°µà°°à°£à°‚ à°šà°¾à°²à°¾ à°…à°‚à°¦à°‚à°—à°¾ à°‰à°‚à°¦à°¿.",
        "à°¨à±‡à°¨à± à°ªà±à°°à°¤à°¿à°°à±‹à°œà±‚ à°•à±Šà°¤à±à°¤ à°µà°¿à°·à°¯à°¾à°²à± à°¨à±‡à°°à±à°šà±à°•à±‹à°µà°¡à°‚ à°‡à°·à±à°Ÿà°ªà°¡à°¤à°¾à°¨à±.",
        "à°¸à°¾à°‚à°•à±‡à°¤à°¿à°•à°¤ à°µà±‡à°—à°‚à°—à°¾ à°…à°­à°¿à°µà±ƒà°¦à±à°§à°¿ à°šà±†à°‚à°¦à±à°¤à±‹à°‚à°¦à°¿.",
        "à°¦à°¯à°šà±‡à°¸à°¿ à°¤à°¿à°°à°¿à°—à°¿ à°•à°¾à°²à± à°šà±‡à°¯à°‚à°¡à°¿.",
        "à°¸à°®à°¾à°µà±‡à°¶à°‚ à° à°¸à°®à°¯à°‚à°²à±‹ à°·à±†à°¡à±à°¯à±‚à°²à± à°šà±‡à°¯à°¬à°¡à°¿à°‚à°¦à°¿?",
        "à°¨à±‡à°¨à± à°à°¦à± à°¨à°¿à°®à°¿à°·à°¾à°²à±à°²à±‹ à°…à°•à±à°•à°¡à°¿à°•à°¿ à°šà±‡à°°à±à°•à±à°‚à°Ÿà°¾à°¨à±.",
        "à°®à±€ à°¸à°¹à°¾à°¯à°¾à°¨à°¿à°•à°¿ à°§à°¨à±à°¯à°µà°¾à°¦à°¾à°²à±.",
        "à°•à±ƒà°¤à±à°°à°¿à°® à°®à±‡à°§à°¸à±à°¸à± à°ªà±à°°à°ªà°‚à°šà°¾à°¨à±à°¨à°¿ à°®à°¾à°°à±à°¸à±à°¤à±‹à°‚à°¦à°¿.",
        "à°®à±€à°°à± à°¨à°¨à±à°¨à± à°¸à±à°ªà°·à±à°Ÿà°‚à°—à°¾ à°µà°¿à°¨à°—à°²à°°à°¾?",
        "à°¨à±‡à°¨à± à°ˆ à°ªà±à°°à°¾à°œà±†à°•à±à°Ÿà±â€Œà°¨à± à°ˆà°°à±‹à°œà± à°ªà±‚à°°à±à°¤à°¿ à°šà±‡à°¯à°¾à°²à°¿.",
        "à°¶à±à°­à±‹à°¦à°¯à°‚, à°®à°‚à°šà°¿ à°°à±‹à°œà± à°•à°²à°—à°¾à°²à°¨à°¿ à°•à±‹à°°à±à°•à±à°‚à°Ÿà±à°¨à±à°¨à°¾à°¨à±.",
        "à°µà°šà±à°šà±‡ à°µà°¾à°°à°‚ à°’à°• à°¸à°®à°¾à°µà±‡à°¶à°‚ à°·à±†à°¡à±à°¯à±‚à°²à± à°šà±‡à°¦à±à°¦à°¾à°‚.",
        "à°‡à°¦à°¿ à°šà°¾à°²à°¾ à°®à±à°–à±à°¯à°®à±ˆà°¨à°¦à°¿.",
        "à°¨à±‡à°¨à± à°®à±€à°•à± à°¸à°¹à°¾à°¯à°‚ à°šà±‡à°¯à°¡à°¾à°¨à°¿à°•à°¿ à°‡à°•à±à°•à°¡ à°‰à°¨à±à°¨à°¾à°¨à±.",
    ]
}

async def generate_voice_sample(text, voice, output_path):
    """Generate a single AI voice sample"""
    try:
        communicate = edge_tts.Communicate(text, voice)
        await communicate.save(str(output_path))
        return True
    except Exception as e:
        print(f"      Error: {e}")
        return False

async def generate_for_language(lang_name, config):
    """Generate all AI voices for a specific language"""
    
    count = config['count']
    voices = config['voices']
    texts = SAMPLE_TEXTS[lang_name]
    
    output_dir = Path(f'data/ai_generated/{lang_name}')
    output_dir.mkdir(parents=True, exist_ok=True)
    
    print(f"\nğŸ™ï¸  {lang_name.upper()}")
    print(f"   Target: {count} AI voice samples")
    print(f"   Voices: {len(voices)} different AI voices")
    
    generated = 0
    batch_size = 50  # Generate in batches for progress updates
    
    for i in range(count):
        # Rotate through different voices for variety
        voice = voices[i % len(voices)]
        
        # Cycle through sample texts
        text = texts[i % len(texts)]
        
        # Add variation to text
        if i >= len(texts):
            # Add prefix/suffix for variation
            prefixes = ["", "Listen carefully: ", "Note that ", "Please remember: "]
            suffixes = ["", " Thank you.", " That's all.", " End of message."]
            text = f"{random.choice(prefixes)}{text}{random.choice(suffixes)}"
        
        output_path = output_dir / f"ai_clip_{i:05d}.mp3"
        
        success = await generate_voice_sample(text, voice, output_path)
        
        if success:
            generated += 1
            
            if (generated % batch_size == 0) or (generated == count):
                print(f"   âœ“ Generated {generated}/{count} samples...")
        else:
            print(f"   âš ï¸  Failed to generate sample {i}")
    
    print(f"   âœ… Complete! Generated {generated} AI voice samples")
    return generated

async def main():
    print("ğŸ¤– AI Voice Generation Tool")
    print("=" * 60)
    print("Using Microsoft Edge TTS (Free, High Quality)")
    print("=" * 60)
    
    total_generated = 0
    
    for lang_name, config in VOICE_CONFIG.items():
        generated = await generate_for_language(lang_name, config)
        total_generated += generated
    
    print("\n" + "=" * 60)
    print("ğŸ‰ AI Voice Generation Complete!")
    print(f"\nğŸ“Š Total AI Samples Generated: {total_generated}")
    print("\nğŸ’¾ Files saved to: data/ai_generated/")
    print("\nâœ… Dataset Ready for Training!")
    print("\nNext step: Train your AI voice detection model")

if __name__ == "__main__":
    print("â³ Starting AI voice generation... This will take 30-60 minutes.")
    print("ğŸ’¡ Tip: You can interrupt with Ctrl+C if needed\n")
    
    asyncio.run(main())
